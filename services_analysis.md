# Integrated Manager サービス実装状況分析

## 概要

このドキュメントでは、Integrated Manager プロジェクトの各サービスの実装状況、情報の読み取り元、処理ロジック、生成内容について詳細に分析します。

## 1. AI 処理サービス (aiProcessing.js)

### 情報読み取り元

- **Google Drive API**: プロジェクトフォルダ内の各フォルダ（Document, Implementation, Presentation 等）
- **スキャン結果**: diffDetection.js から取得したフォルダ構造とファイル情報
- **Main ドキュメント**: Document フォルダ内の"Main"という名前を含むファイル

### 処理ロジック

1. **フォルダタイプ別処理**: 8 つのフォルダタイプ（Document, Implementation, Presentation 等）に対応する専用処理関数
2. **クロスフォルダ分析**: 複数フォルダの情報を統合して分析
3. **プレースホルダー実装**: 実際の AI API 呼び出しは未実装（モックデータ生成）

### 生成内容

- **Document**: 要約、アウトライン、重複分析、論文トピック提案
- **Implementation**: 変更履歴、仕様書、アーキテクチャ図（Mermaid 形式）
- **Presentation**: スライド草案、図表、外部調査資料、クロスフォルダ分析
- **その他フォルダ**: 各フォルダタイプに応じた専門的な分析結果

### 現在の状況

- ✅ 基本構造は完成
- ❌ 実際の AI API 連携は未実装
- ⚠️ プレースホルダー関数でモックデータ生成

---

## 2. 論文トピック提案サービス (paperTopicSuggestion.js)

### 情報読み取り元

- **Document フォルダ**: Main ドキュメントを検索・読み込み
- **Google Drive API**: ファイル内容の取得（Google Docs, テキストファイル対応）

### 処理ロジック

1. **Main ドキュメント検索**: 柔軟な検索パターン（完全一致 → 部分一致 → フォールバック）
2. **内容分析**: キーポイント抽出、テーマ特定
3. **論文トピック生成**: 5 つのカテゴリ（技術革新、プロセス、UX、アーキテクチャ、学際的）
4. **フォルダ作成**: Academia/Paper Topic Suggestion フォルダの自動作成

### 生成内容

- **Suggestion ファイル**: 詳細な論文トピック提案（Markdown 形式）
- **5 つの研究テーマ**: 各テーマの概要、意義、研究手法、次ステップ
- **統計情報**: 文字数、キーポイント数、テーマ分析

### 現在の状況

- ✅ 完全実装済み
- ✅ Google Drive API 連携完了
- ✅ エラーハンドリング強化
- ✅ ファイル作成・更新機能

---

## 3. スライド生成サービス (slideGeneration.js)

### 情報読み取り元

- **Document フォルダ**: 全ドキュメントファイルの読み込み
- **Main ドキュメント**: 優先的に使用されるメインドキュメント

### 処理ロジック

1. **コンテンツ分析**: 見出し構造、段落分割、箇条書き抽出
2. **スライド構造生成**: タイトル、コンテンツ、まとめスライドの自動生成
3. **PPTX 作成**: pptxgenjs ライブラリを使用した PowerPoint ファイル生成
4. **Google Drive 保存**: 生成された PPTX ファイルの自動保存

### 生成内容

- **PowerPoint ファイル**: 完全なプレゼンテーション（.pptx 形式）
- **スライド構造**: タイトル、コンテンツ、まとめスライド
- **デザイン**: 統一されたスタイル、背景色、フォント設定

### 現在の状況

- ✅ 完全実装済み
- ✅ pptxgenjs 連携完了
- ✅ Google Drive 保存機能
- ✅ エラーハンドリング

---

## 4. 論文生成サービス (paperGeneration.js)

### 情報読み取り元

- **Document/ForAca**: "foraca"を含むファイル名のドキュメント
- **Academia フォルダ**: 論文関連ファイル（.md, .txt, paper, research 等）
- **スキャン結果**: フォルダ構造情報

### 処理ロジック

1. **ソースドキュメント統合**: ForAca と Academia の内容を結合
2. **論文構造生成**: タイトル、アブストラクト、セクション、参考文献
3. **LaTeX 生成**: 完全な LaTeX ファイルの作成
4. **PDF 変換**: LaTeX API または jsPDF を使用した PDF 生成

### 生成内容

- **LaTeX ファイル**: 完全な論文テンプレート（.tex 形式）
- **PDF ファイル**: コンパイル済み論文（.pdf 形式）
- **論文構造**: Introduction, Related Work, Methodology, Implementation, Results, Conclusion

### 現在の状況

- ✅ 基本実装完了
- ✅ LaTeX 生成機能
- ⚠️ PDF 変換は複数フォールバック方式
- ❌ 実際の LaTeX API 連携は未実装

---

## 5. 参考論文検索サービス (referencePaperSearch.js)

### 情報読み取り元

- **Document/Main**: Main ドキュメントの内容
- **Academia/Paper Topic Suggestion/Suggestion**: 生成された論文トピック提案

### 処理ロジック

1. **キーワード抽出**: 技術・研究関連キーワードの自動抽出
2. **関連度計算**: キーワードベースのスコアリング
3. **モック論文検索**: デモ用の論文データベース
4. **Excel 生成**: XLSX ライブラリを使用した Excel ファイル作成

### 生成内容

- **Excel ファイル**: 関連論文一覧（.xlsx 形式）
- **3 つのシート**: 論文一覧、検索情報、年度別統計
- **論文情報**: タイトル、著者、年、ジャーナル、URL、関連度スコア

### 現在の状況

- ✅ 基本実装完了
- ✅ Excel 生成機能
- ❌ 実際の論文検索 API 連携は未実装
- ⚠️ モックデータのみ

---

## 6. 素材要件作成サービス (requirementsCreator.js)

### 情報読み取り元

- **プロジェクト構造**: Academia、Presentation フォルダの存在確認
- **既存ファイル**: 既存の要件ファイルの確認

### 処理ロジック

1. **フォルダ確認**: Academia、Presentation フォルダの存在チェック
2. **要件データ生成**: カテゴリ別のデフォルト要件データ
3. **Excel 作成**: XLSX ライブラリを使用した要件ファイル生成
4. **重複チェック**: 既存ファイルがある場合はスキップ

### 生成内容

- **Academia 要件**: 研究手法、データ分析、実験設計等の素材要件
- **Presentation 要件**: スライド番号別の素材要件
- **Excel 形式**: カテゴリ、素材タイプ、キーワード、優先度、用途、ステータス

### 現在の状況

- ✅ 完全実装済み
- ✅ Excel 生成機能
- ✅ 重複チェック機能

---

## 7. 素材収集サービス (materialCollector.js)

### 情報読み取り元

- **要件ファイル**: Academia/Presentation の Material_Requirements.xlsx
- **プロジェクト構造**: Material フォルダの存在確認・作成

### 処理ロジック

1. **要件読み込み**: Excel ファイルの解析
2. **未収集素材特定**: ステータスが"未収集"の要件を抽出
3. **ハイブリッド収集**: 画像、グラフ、アイコンの収集
4. **Material フォルダ保存**: サブフォルダ（Images, Charts, Icons）に分類保存

### 生成内容

- **画像**: Unsplash API（モック）からの画像収集
- **グラフ**: Chart.js を使用したグラフ生成
- **アイコン**: Heroicons からの SVG アイコン
- **PNG/SVG ファイル**: Google Drive への保存

### 現在の状況

- ✅ 基本実装完了
- ✅ Excel 読み込み機能
- ❌ 実際の素材収集 API 連携は未実装
- ⚠️ モックデータとプレースホルダー

---

## 8. Document 自動整理サービス (documentOrganizer.js)

### 情報読み取り元

- **Document フォルダ**: 全ドキュメントファイルの読み込み
- **ファイル内容**: テキスト内容の分析

### 処理ロジック

1. **ドキュメント分類**: Main、Topic、ForTech、ForAca の 4 カテゴリ
2. **スコア計算**: キーワードベースの信頼度スコアリング
3. **整理ドキュメント生成**: カテゴリ別の統合ドキュメント
4. **レポート生成**: 整理結果の詳細レポート

### 生成内容

- **整理ドキュメント**: カテゴリ別の Markdown ファイル
- **分類レポート**: 詳細な分析結果レポート
- **統計情報**: 信頼度、分類理由、統計データ

### 現在の状況

- ✅ 完全実装済み
- ✅ 分類アルゴリズム完成
- ✅ レポート生成機能

---

## 9. フォルダ内容要約サービス (folderContentSummary.js)

### 情報読み取り元

- **スキャン結果**: diffDetection.js からのフォルダ情報
- **AI 処理結果**: aiProcessing.js からの処理結果

### 処理ロジック

1. **ファイルタイプ分析**: ドキュメント、画像、コード等の分類
2. **プレビュー生成**: フォルダタイプ別の要約表示
3. **キャッシュ管理**: 5 分間のキャッシュ機能
4. **変更検出**: 24 時間以内の変更ファイル特定

### 生成内容

- **フォルダ要約**: ファイル数、タイプ、最新ファイル情報
- **プレビュー**: 絵文字付きの簡潔な要約
- **変更情報**: 最近の変更ファイル一覧

### 現在の状況

- ✅ 完全実装済み
- ✅ キャッシュ機能
- ✅ フォルダ別プレビュー

---

## 10. 差分検出サービス (diffDetection.js)

### 情報読み取り元

- **Google Drive API**: プロジェクトフォルダの全ファイル情報
- **ローカルストレージ**: 前回スキャン結果の保存

### 処理ロジック

1. **プロジェクトスキャン**: 全フォルダ・ファイルの情報取得
2. **差分検出**: 前回スキャンとの比較
3. **変更分類**: 新規、変更、削除ファイルの特定
4. **履歴管理**: ローカルストレージでのスキャン履歴保存

### 生成内容

- **スキャン結果**: 現在のプロジェクト状態
- **変更情報**: 変更されたファイル・フォルダの詳細
- **統計情報**: 変更数、影響を受けたフォルダ数

### 現在の状況

- ✅ 完全実装済み
- ✅ 差分検出アルゴリズム
- ✅ 履歴管理機能

---

## 11. Google Drive サービス (googleDrive.js)

### 情報読み取り元

- **Google API**: Google Drive API、Google Identity Services
- **環境変数**: API Key、Client ID

### 処理ロジック

1. **API 初期化**: Google API Client Library、GIS Token Client
2. **認証管理**: OAuth 2.0 認証、トークン管理
3. **プロジェクト管理**: プロジェクト作成、フォルダ構造生成
4. **ファイル操作**: ファイル作成、アップロード、検索

### 生成内容

- **プロジェクト構造**: 標準化されたフォルダ構造
- **認証状態**: アクセストークン管理
- **ファイル操作**: Google Drive 上のファイル・フォルダ操作

### 現在の状況

- ✅ 完全実装済み
- ✅ OAuth 2.0 認証
- ✅ プロジェクト管理機能

---

## 実装状況サマリー

### 完全実装済み ✅

1. **論文トピック提案サービス** - 完全動作
2. **スライド生成サービス** - 完全動作
3. **素材要件作成サービス** - 完全動作
4. **Document 自動整理サービス** - 完全動作
5. **フォルダ内容要約サービス** - 完全動作
6. **差分検出サービス** - 完全動作
7. **Google Drive サービス** - 完全動作

### 基本実装済み（API 連携未実装）⚠️

1. **AI 処理サービス** - プレースホルダー実装
2. **論文生成サービス** - PDF 変換部分
3. **参考論文検索サービス** - モックデータ
4. **素材収集サービス** - モックデータ

### 次のステップ

1. **OpenAI API 連携**: AI 処理サービスの実際の AI API 呼び出し実装
2. **論文検索 API 連携**: 実際の論文データベース API 連携
3. **素材収集 API 連携**: Unsplash、Chart.js 等の実際の API 連携
4. **LaTeX API 連携**: 論文生成の PDF 変換機能強化

---

## 技術スタック

### フロントエンド

- **React.js**: メイン UI フレームワーク
- **Vite**: ビルドツール
- **Tailwind CSS**: スタイリング

### 外部 API

- **Google Drive API**: ファイル・フォルダ管理
- **Google Identity Services**: OAuth 2.0 認証
- **pptxgenjs**: PowerPoint ファイル生成
- **XLSX**: Excel ファイル操作
- **Chart.js**: グラフ生成（予定）

### 開発環境

- **Node.js**: 開発環境
- **ESLint**: コード品質管理
- **環境変数**: API 認証情報管理

---

_このドキュメントは各サービスの実装状況を正確に反映しています。実際の API 連携実装時には、この分析を基に優先順位を決定してください。_
